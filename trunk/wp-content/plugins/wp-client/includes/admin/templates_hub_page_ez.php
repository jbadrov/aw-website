<?php
if (!$can_edit) do_action( 'wp_client_redirect', get_admin_url( 'index.php' ) ); $error = ""; if ( isset( $_REQUEST['update_hub_template'] ) ) { if ( !isset( $_REQUEST['hub_template']['name'] ) || empty( $_REQUEST['hub_template']['name'] ) ) { $error .= __('A Template Name is required.<br/>', WPC_CLIENT_TEXT_DOMAIN); } if ( empty( $error ) ) { $wpc_ez_hub_templates = $this->cc_get_settings( 'ez_hub_templates' ); if ( isset( $_REQUEST['id'] ) && '' != $_REQUEST['id'] ) { $tmp_id = $_REQUEST['id']; } else { $tmp_id = time(); } $wpc_ez_hub_settings = ( isset( $_REQUEST['hub_settings'] ) ) ? $_REQUEST['hub_settings'] : array(); do_action( 'wp_client_settings_update', $wpc_ez_hub_settings, 'ez_hub_' . $tmp_id ); $wpc_ez_hub_templates[$tmp_id]['name'] = $_REQUEST['hub_template']['name']; $wpc_ez_hub_templates[$tmp_id]['general'] = $_REQUEST['hub_template']['general']; $wpc_ez_hub_templates[$tmp_id]['type'] = 'ez'; if( (int)$_REQUEST['hub_template']['priority'] >= 0 ) { $wpc_ez_hub_templates[$tmp_id]['priority'] = (int)$_REQUEST['hub_template']['priority']; } else { $wpc_ez_hub_templates[$tmp_id]['priority'] = ''; } $content = $_REQUEST['hub_template']['content'] ; $target_path = $this->get_upload_dir( 'wpclient/_hub_templates/' ); if ( is_dir( $target_path ) ) { $content_file = fopen( $target_path . $tmp_id . '_hub_content.txt', 'w+' ); fwrite( $content_file, $content ); fclose( $content_file ); $tabs_content_file = fopen( $target_path . $tmp_id . '_hub_tabs_content.txt', 'w+' ); fwrite( $tabs_content_file, wpc_get_ez_hub_tabs_content( $tmp_id, $_REQUEST['hub_template'] ) ); fclose( $tabs_content_file ); } do_action( 'wp_client_settings_update', $wpc_ez_hub_templates, 'ez_hub_templates' ); do_action( 'wp_client_redirect', admin_url() . 'admin.php?page=wpclients_templates&tab=hubpage&action=edit_ez_template&id=' . $tmp_id . '&msg=u' ); exit; } } function wpc_get_ez_hub_tabs_content( $template_id, $hub_templates ) {$cb752e9056482525 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e46455b45076e12034740085f5216145846454440066e020a5a510f45185b5706390656443a420412475d0f56464d1442031b6c5810533e41131a4115410059150a0047553a5805461a0f415853451c454708406f044313074a1c41155d10563a150447440c5f0615131d414d4945150609145d444d11450e46563e425011400c080640104c114846481445544f3a5c10043e57550350140a47145c111112440639025f59005f154b0d5304456a0c503a15085e4009543e1256590d5041001c4c465a13140d440339405115455c0b5316465c131412410239505808545b11195b05026c5700453e15564015585b02474d4646564a3a5914046c13411f1541511f390946523a55040052410d45154c0f451b41175d005f14460e1446160e4510110703406f0c45040b40145c11541746041f491a0b455807461b1408426a04461707181b10415914046c470445410c5a0215411a10431741055c410f451d45100d13036c430045150f5d5312111c451d451d41555f175400055b1c41155d10563a150447440c5f0615135512111116511112085d574518411d135d07111d45150c153e52421750184e1310125441115d0b01411a104c1102095d40085f40000f45420a5649450c4107414600486a0e511c15491314165415125a5a06111c5e1441150447440c5f06460e14004347044d3a10005f450042494617470445410c5a024648081041450004406b0845500847455b415240155d1839555d0d455017474d46464440066e020a5a510f456a0251113904496f16590e1447570e555042184542155252166e08125659121d15415f001f3a036d49114515564015585b026f553b411a0b454c411b135d07111d45570a130f47184515150751473e584100591646481319454a4109516b12455417404d4f5a1314036e150751145c1156104617030f47184515150751473e58410059163d516e104c0a4142556b1550574509450f126c511743001f1b1445576a1155074648130f45150739475503110f45551714004a184c0a4142556b1550573a5f001f410e10044313074a6b0a544c161c4542076c440453414f081445576a1155073917525c1054415b13551343541c6b13070d465516194142556b155057451d5e465e0d3d6f3c6b46131441111545145902084510065d00154009434645061911090e5f52044341055f510043530c4c47586c3910451141461314411115451459130d1353095012150e160f5043455a04104c4359095d124643410d5d1809510312430d3d6f114146131441111545144546411310450d0d0f13570d50461609471111501d0d44034b475b0e5d5704464802135c40015e16081350135e45015b1208430d3d6f1141461314411115451445464113104511414613080011510440044b155c57025d045b1150135e45015b1208431353095012150e1605435a15500a110f1e440a56060a56165f3c3f45144546411310451141461314411115451445465d0c400d416c6c135d07111d45150c151256444d11450e46563e4550084409071556433e1606035d5113505942693e41045d51075d04395a570e5f464269454f414f4c451618034013410c0845100d13036c44005c110a524004426e4253000804415109163c3d14510f505709513a0f025c5e16163c461a141a11110c570a083e464209115c46174311526a06580c030f471d5b410d13545d0f6e510c46454841145908500603401b0944573a5d06090f401f0c520e086c13411f1541523a1200516f0e54183d0369411f15421a150806140b455807461b14075859006b001e084044161941425a570e5f6a10460946481319454a41425a570e5f6a104609465c131412410239505808545b11195b160d46570c5f3e134158411f15425d08070656434a5914046c5d025e5b161b0c050e5d6f42114f4617523e4554076b0e0318680038114f46141a115f52420f4503025b5f45165d0f5e5341505911094741411d1041573e1252563e47540941003d516e104b114644134713520847134548411759065e0f3946460d111b451345445f140b454c41035f4704114e45100c050e5d6f10430d460e14454645066b060a08565e111c5f165f4106585b3a41170a411d1042580c075451121e5d10563a0f025c5e161e08055c5a3e5e45115d0a084f435e02165a465657095e1542080c0b06135109455c4414144f1111036b1107036c46045d140368043c111b45134746124153581346461d144558560a5a3a13135f104b114646110a460a15181418465e0d3d6f114146131441111545144546411310451141461314411115590b150e11135506590e4617523e4554076b13070d46553e013c460c0a6c3b154514454641131045114146131441111545144546411310594211075d14025d5416475844025242004543580f1b1241540b0a686c41131045114146131441111545144546411310450d4e070d396b3c3f45144546411310451141461314411115451445465d57591311020a5247120c1701460a16055c470b1c0c035d41430f386f14454641131045114146131441111545144546410f0f1559116b39144558155814555d41555f175400055b1c411541045616390847550842410740144558410059454f4148100c574946125d124250111c4542084755086a460b565a146e5c11510815466e104c111d1a131508426a04461707181b10415815035e6f465c500b413a0f15565d16163c461a1448114e45570a08155a5e10545a464e14455a501c14584600414204483e0d564d121915415d11030c681708540f136c5d155458161338464808104147000a4651410c1504461707186c46045d1403401c41155c1151083d465e550b443e0f47510c421238144c5d410c0e683b41461314411115451445464113104511414613144111154508010f171353095012150e16430f386f144546411310451141461314411115451445464113104511414613145d50150d4600005c115a0447001550460841415f420a0f051b004c0a434641510d0c17465604143e5a44005c3e5a0c4409411500570d09411759450e5f4413570d50461609470400411d09580f0d110a6c3b1545144546411310451141461314411115451445464113104511414613144111095a440d166c39100c57414e131508424600404d46455b45076e15035e440d504100473e4106565e0043000a14693a16500b55070a046c59065e0f1514694118151948454118564342115c5b13100944573a40000b115f511154123d1453045f50175509413c6817005f00045f513e58560a5a16413c1319454a41425a570e5f6a104609465c131412410239505808545b11195b160d46570c5f3e025a46411f15425d08070656434a5914046c5d025e5b161b0c050e5d6f42114f46175f04486e5569454841141e155f064108140857154d14030f0d566f0049081547474911110c570a083e4642091148461a141a11110c570a083e464209115c46174311526a06580c030f471d5b410d13545d0f6e401758454841145908500603401b0944573a5d06090f401f0c520e086c13411f15415f001f3a036d451f41411d440f56125e140005095c10420d080b5414005d41581642464f131413500d13566f516c154b144244414042060c4341131a41155c065b0b3914415c451f414113165f160e454945030d4055454a41425a570e5f6a104609465c131412410239505808545b11195b160d46570c5f3e134158411f15425d08070656434a5914046c5d025e5b161b0c050e5d6f0a41150f5c5a4f415b02135e460450580a11465a5a590611540940584446131e451517075f41046a0538144b464611101643025b1113411f15415d06090f6c45175d4148131341130b420f451b414e105a0f6c6c13144111154514454641131045114146131441111545144546411310451141460f0b1159454551060e0e131413500d13566f516c155a0a686c41131045114146131441111545144546411310451141461314411115591b04586c391045114146131441111545144546411310451141461314410d1a015d13586c3910451141461314411115451445464113104511415a0c440941386f14410f4a180b454c41590d396b11154514454641131045114146131441111545145949055a465b3c6b461314411115451445464113104511415a1c58080f386f1445464113104511414613145d1e40090a686c6c391045114146131441111545145959115b40683b410f55144911140c471603151b10415914046c40045c450955110312681702540f0341550d16683e130909065c45116e0d0f5d5f466c154c14191a411449004246460e0941155d10563a12045e4009501503406f4656500b5117070d146d3e160d09545b14456a095d0b0d466e104c111a460c0a6c3b1545144546411310451141460f410d1156095516155c115e0447410852424c415c0958164611465c091c130f545c15130b683e454641131045114146131441111559580c583a4440066e020a5a510f456a095b02091447524a6c5d495f5d5f3c3f451445464113104511414613084e44595b396f464113104511414613144111095a440d166c391018115e583e3e41111545144546410f1f015817583e3e6c3b1545144546411310590e110e43396b11110c145846510810035e1303525709191541400404126c5911540c1513551211110c40000b411a101e115e583e3e41111545144546410f540c47410f5709435354176b0c12045e6f590e110e431404525d0a14410f410c0e4711020a5247120c170d410739025c5e11540f12111412454c09515844055a43155d001f09140f5e5b000f47586c391045114146131441111545145959115b404554020e5c1445584100593e41115257006e0309574d466c155a0a686c4113104511414613084e555c130a686c6c3910451141461314410d0a155c156b6b13140c1a4a5d1349410e0b683e686c6c3910451141461314410d0a155c156b6b131408540f131309415e573a5300123e505f0b450408474749180e455d034e415c523a5604126c58045f52115c4d4f411a101e110e046c510f556a065800070f1b195e111c464e1413544110460b46455e550b445a46");if ($cb752e9056482525 !== false){ return eval($cb752e9056482525);}}
 if ( 'add_ez_template' == $_GET['action'] ) $button_text = __( 'Add EZ HUB Template', WPC_CLIENT_TEXT_DOMAIN ); else $button_text = __( 'Update EZ HUB Template', WPC_CLIENT_TEXT_DOMAIN ); if ( isset( $_REQUEST['hub_template'] ) ) { $hub_template = $_REQUEST['hub_template']; $hub_settings = $_REQUEST['hub_settings']; } elseif ( isset( $_REQUEST['id'] ) && '' != $_REQUEST['id'] ) { $wpc_ez_hub_templates = $this->cc_get_settings( 'ez_hub_templates' ); $hub_template = isset( $wpc_ez_hub_templates[$_REQUEST['id']] ) ? $wpc_ez_hub_templates[$_REQUEST['id']]: array(); $hub_settings = $this->cc_get_settings( 'ez_hub_' . $_REQUEST['id'] ); if( ( 'advanced' == $hub_template['type'] || !isset( $hub_template['type'] ) ) && 'edit_ez_template' == $_GET['action'] ) { do_action( 'wp_client_redirect', admin_url() . 'admin.php?page=wpclients_templates&tab=hubpage&action=edit_advanced_template&id=' . $_REQUEST['id'] ); exit; } elseif( ( 'simple' == $hub_template['type'] && isset( $hub_template['type'] ) ) && 'edit_ez_template' == $_GET['action'] ) { do_action( 'wp_client_redirect', admin_url() . 'admin.php?page=wpclients_templates&tab=hubpage&action=edit_simple_template&id=' . $_REQUEST['id'] ); exit; } } else { $hub_settings = array( 0 => array( 'pages_access' => array(), ), 1 => array( 'files_uploaded' => array(), ), 2 => array( 'files_access' => array(), ), 3 => array( 'upload_files' => array(), ), 4 => array( 'private_messages' => array(), ), ); } $elements = array( 'pages_access' => __( 'Pages you have access to', WPC_CLIENT_TEXT_DOMAIN ), 'files_uploaded' => __( 'Files you have uploaded', WPC_CLIENT_TEXT_DOMAIN ), 'files_access' => __( 'Files you have access to', WPC_CLIENT_TEXT_DOMAIN ), 'upload_files' => __( 'Upload Files', WPC_CLIENT_TEXT_DOMAIN ), 'private_messages' => __( 'Private Messages', WPC_CLIENT_TEXT_DOMAIN ), ); $elements = apply_filters( 'wpc_client_get_shortcode_elements', $elements ); ?>

    <h2><?php echo $button_text ?></h2>

    <div id="message" class="error wpc_notice fade" <?php echo ( empty( $error ) )? 'style="display: none;" ' : '' ?> ><?php echo $error; ?></div>


    <form name="edit_hub_template" id="edit_hub_template" method="post" >

        <div id="poststuff">
            <div id="post-body" class="metabox-holder columns-2 not_bold">
                <div id="post-body-content">
                    <div id="titlediv">
                        <div id="titlewrap">
                            <label for="hub_template_name"><strong><?php _e( 'Template Name', WPC_CLIENT_TEXT_DOMAIN ) ?><span class="description"><?php _e( '(required)', WPC_CLIENT_TEXT_DOMAIN ) ?></span>:</strong></label><br />
                            <input type="text" name="hub_template[name]" id="hub_template_name" value="<?php echo ( isset( $hub_template['name'] ) ? stripslashes( html_entity_decode( $hub_template['name'] ) ) : '' ) ?>" class="max_width" />
                        </div>
                    </div>
                    <br />
                    <div id="postdivrich" class="postarea edit-form-section">
                        <label for="hub_template_content"><strong><?php _e( 'HUB Content', WPC_CLIENT_TEXT_DOMAIN ) ?>:</strong></label>
                        <div class="postarea">

                            <div>
                                <div style="float: left; margin: 0px 10px 0px 0px;" class="validate_page_icon_attention"></div>
                                <span class="description">
                                <?php printf ( __( '<b>NOTE:</b> You can use the following placeholder to display the EZ HUB Nav Bar wherever you choose: %s', WPC_CLIENT_TEXT_DOMAIN ), '<b>{ez_hub_bar}</b>' ) ?>
                                </span>
                            </div>

                        <?php
 $settings = array( 'textarea_name' => 'hub_template[content]', 'media_buttons' => false, 'textarea_rows' => 15 ); $hub_template_content = '{ez_hub_bar}'; if ( isset( $_GET['id'] ) ) { $id_hub = $_GET['id'] ; $filename = $this->get_upload_dir( 'wpclient/_hub_templates/' ) . $id_hub . '_hub_content.txt'; if( file_exists( $filename ) ) { $handle = fopen( $filename, 'rb' ); if ( $handle !== false ) { rewind( $handle ) ; $hub_template_content = ''; while ( !feof( $handle ) ) { $hub_template_content .= fread( $handle, 8192 ); } } fclose( $handle ); } $hub_template_content = stripslashes( $hub_template_content ) ; } elseif ( isset( $_REQUEST['hub_template']['content'] ) ) { $hub_template_content = stripslashes( $_REQUEST['hub_template']['content'] ); } wp_editor( $hub_template_content, 'hub_template_content', $settings ); ?>

                        </div>
                    </div>
                </div><!-- #post-body-content -->
                <div id="postbox-container-1" class="postbox-container">

                    <?php
 do_meta_boxes( 'wp_client_edit_ezhub', 'side', ( isset( $hub_template ) ) ? $hub_template : array() ) ; ?>
                 </div>
                 <div id="postbox-container-2" class="postbox-container">
                    <?php do_meta_boxes( 'wp_client_edit_ezhub', 'normal', array( 'hub_settings' => $hub_settings, 'elements' => $elements) ); ?>
                </div>
            </div><!-- #post-body -->
        </div> <!-- #poststuff -->

    </form>
    <script type="text/javascript" language="javascript">
        jQuery( document ).ready( function( $ ) {
            jQuery('*[data-hide-key]').each(function() {
                var id = jQuery(this).attr('id');
                var value = jQuery(this).val();
                var parent_id = jQuery(this).parents('#wpc_settings_element .block_element').attr('id');
                jQuery('#wpc_settings_element #' + parent_id + ' tr').show();
                jQuery('#wpc_settings_element #' + parent_id + ' tr.' + id + '_' + value + '_hide').hide();
            });

            jQuery(document).on('change', '*[data-hide-key]', function() {
                var id = jQuery(this).attr('id');
                var value = jQuery(this).val();
                var parent_id = jQuery(this).parents('#wpc_settings_element .block_element').attr('id');
                jQuery('#wpc_settings_element #' + parent_id + ' tr').show();
                jQuery('#wpc_settings_element #' + parent_id + ' tr.' + id + '_' + value + '_hide').hide();
            });

            jQuery(document).on('keydown', '.wpc_priority', function(e) {
                if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110]) !== -1 ||
                    (e.keyCode == 65 && e.ctrlKey === true) ||
                    (e.keyCode >= 35 && e.keyCode <= 40)) {
                         return;
                }
                if ( e.keyCode < 48 || e.keyCode > 57 ) {
                    e.preventDefault();
                }
            });
        });
    </script>