<?php
global $wpdb; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), stripslashes_deep( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_content&tab=files_downloads'; } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), stripslashes_deep( $_SERVER['REQUEST_URI'] ) ) ); exit; } if ( !ini_get( 'safe_mode' ) ) { @set_time_limit(0); } $filter = ''; $where_search = ''; $where_filter = ''; $where_manager = ''; $wpc_file_sharing = $this->cc_get_settings( 'file_sharing' ); if ( isset( $_GET['filter'] ) ) { switch ( $_GET['filter'] ) { case 'downloaded_by': if ( isset( $_GET['downloaded_by'] ) ) { $downloaded_by = $_GET['downloaded_by']; $where_filter .= " AND dl.client_id='" . (int)$downloaded_by . "'" ; } if ( isset( $_GET['file'] ) && !empty( $_GET['file'] ) && 'all' != $_GET['file'] ) { $file = $_GET['file']; $where_filter .= " AND dl.file_id='" . (int)$file . "'" ; } break; case 'file': if ( isset( $_GET['downloaded_by'] ) && !empty( $_GET['downloaded_by'] ) && 'all' != $_GET['downloaded_by'] ) { $downloaded_by = $_GET['downloaded_by']; $where_filter .= " AND dl.client_id='" . (int)$downloaded_by . "'" ; } if ( isset( $_GET['file'] ) ) { $file = $_GET['file']; $where_filter .= " AND dl.file_id='" . (int)$file . "'" ; } break; } } if ( isset( $_REQUEST['s'] ) && '' != $_REQUEST['s'] ) { $search = strtolower( trim( $_REQUEST['s'] ) ); $where_search = " AND (
        LOWER( f.title ) LIKE '%" . $search . "%' OR
        LOWER( dl.download_date ) LIKE '%" . $search . "%' OR
        LOWER( u.user_login ) LIKE '%" . $search . "%'
    )"; } $order_by = 'dl.download_date'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'file_title' : $order_by = 'f.title'; break; case 'author' : $order_by = 'u.user_login'; break; case 'download_date' : $order_by = 'dl.download_date'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if ( current_user_can( 'wpc_manager' ) && !current_user_can( 'administrator' ) ) { $manager_clients = $this->cc_get_assign_data_by_object( 'manager', get_current_user_id(), 'client' ); $manager_circles = $this->cc_get_assign_data_by_object( 'manager', get_current_user_id(), 'circle' ); $client_files = $this->cc_get_assign_data_by_assign( 'file', 'client', $manager_clients ); $circle_files = $this->cc_get_assign_data_by_assign( 'file', 'circle', $manager_circles ); $all_files = array_merge( $client_files, $circle_files ); $all_files = array_unique( $all_files ); if ( current_user_can( 'wpc_view_admin_managers_files' ) ) { $where_manager .= " AND ( ( ( f.page_id = 0 ) OR f.id IN('" . implode( "','", $all_files ) . "')) AND dl.client_id IN('" . implode( "','", $manager_clients ) . "'))"; } else { $where_manager .= " AND ( ( ( f.user_id = " . get_current_user_id() . " ) OR f.id IN('" . implode( "','", $all_files ) . "')) AND dl.client_id IN('" . implode( "','", $manager_clients ) . "'))"; } } if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Clients_List_Table extends WP_List_Table { var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $columns = array(); var $files_for_view = array(); var $bulk_actions = array(); function __construct( $args = array() ){$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("154155170112130d4546113943551342503a551701121b1041501301401841504717551c4e4114430c5f06135f55131615580a45393e1b10425815035e134d116235773a252d7a752b653e32766c356e712a79242f2f1319491146165f4113505942145858416c6f4d11460f47510c421249143236226c7329782428676b35746d316b21292c72792b11484a1313005b541d13455b5f1356045d1203131d41180e45440414045d445f0b3e39505b0f42411741061249131404430615131d5a1111115c0c154c0d560c5d04156c520e436a135d0011410e10044313074a1c4116570844424a4114531642464a13130658534218454109475d09164d46145e1156124914420c115657421d414143500716194513150806141c4516151e47134d11121d5909414d13195e11");if ($cf86af25992f0f32 !== false){ eval($cf86af25992f0f32);}}
 function __call( $name, $arguments ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d1006500d0a6c411254473a521008026c511743001f1b14004347044d4d464547580c424d46175a005c50451d494645524202440c035d4012111c5e14");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function prepare_items() {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541570a0a145e5e16115c461740095846480a0203156c530a5d140b5d4749180e45100d0f0557550b115c46524613504c4d1d5e4645405f174500045f51410c1541400d0f121e0e02541539405b13455407580039025c5c105c0f151b1d5a1111115c0c154c0d6f065e0d135e5a3e59500450001412130d45501314524d491111065b09130c5d434911450e5a5005545b491441150e414404530d03131d5a11");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function column_default( $item, $column_name ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c524d4608404300454946175d1554583e1441050e5f45085f3e085259041168451d454f41481017541513415a41155c1151083d4117530a5d140b5d6b0f50580014385d414e10005d1203134f414350114117084114175e111c46");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function set_sortable_columns( $args = array() ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("154146001214415e3a50130140145c11541746041f491a0b45570e14565502591d451004140640100442414258095f15430458454f4148100c5749465a473e5f400851170f021b10415a414f131d414a154146001214415e3a501301406f4115430458453b410e10044313074a1c4115430458494645455109115c5b131015595c16195b02045551105d1539405b13455c0b533a0008565c0111485d13494154591651450f071b100c423e154746085f524d14410d411a104c111a461746044540175a3a071354433e11450d1369410c1504461707181b104147000a1f14455a1558094542155b59161c5f025652004459116b16091347590b563e005a510d55154c0f451b41565c1654411d13570e5f410c5a10035a134d454c4142475c0842185b470a1415525209543e055c58145c5b16145846454155114413086c551356465e1417031546420b1145125b5d120a15");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function get_sortable_columns() {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f425a174004040d566f065e0d135e5a120a15");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function set_columns( $args = array() ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c524d46025c450b4549461740095846480a07130d586f0452150f5c5a12111c451d451d411751175612460e14004347044d3a0b04415700194107414600481d4513060446130d5b11465a5a5a11444145401c16040e120659040558560e4917451b5b41411a1c45150014544741180e45494542155b59161c5f055c58145c5b1614584645524202425a4641511544470b144112095a435e11");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function get_columns() {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f525a09410808120810");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function set_actions( $args = array() ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541400d0f121e0e0452150f5c5a1211084510041406400b4543041246460f1111115c0c155a13");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function get_actions() {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f5056115d0a08120810");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function set_bulk_actions( $args = array() ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541400d0f121e0e07440d0d6c5502455c0a5a16465c131404430615081413544110460b464547580c425a46");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function get_bulk_actions() {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f5340095f3a070247590a5f125d13");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function column_file_icon( $item ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e4645555909543e124a4404110845511d160d5c54001941411d134d11110c40000b3a14560c5d04085259041668451d5e4645555909543e124a4404110845471114155c5c0a4604141b14045f514d144100085f553a451816561448111c5e144100085f553a45181656145c111d450245585c134311430d035d1c4115530c580039154a40001148461a145e1111035d09033e47491554415c1313145f5e0b5b120846081017541513415a4116090c590246165a5411595c44070443115d005d020e150e12510143464046020c1742144b46454440066e020a5a510f45185b5706390656443a57080a565d025e5b4d144100085f553a451816561448111b45134746025f5116425c4452401550560d590008151e08554957561114005d41581642464f131403580d036c40184150451a45414313440c450d030e1646111b4510030f0d566f11481103131a411617451b5b415a13");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function column_file_title( $item ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e4645555909543e124a4404110845511d160d5c54001941411d134d11110c40000b3a14560c5d04085259041668451d5e4645555909543e124a4404110845471114155c5c0a4604141b14045f514d144100085f553a451816561448111c5e144100085f553a4508125f51410c154d140c151256444d11450f47510c6a12115d110a04146d45184140151446161544094542084755086a46125a400d541238144c465e13140c45040b68131558410951423b410910415815035e6f465f540851423b5a13141158150a566b09455809145846460f590b411412134018415058160d0f0557550b13410f5709435046165d02083e5d5108543e045f5b025a6a42144b46455a44005c3a415a50466c154b1442444145510944045b1113411f15415d11030c68170b500c031469411f15421645495f3e3a4511414613144111154514455a1243510b1108020e16075859006b0b070c566f075d0e05586b46111b45100c12045e6b425805416e144f1112470a686c411310451141461314411115451445465d52100d4304000e1646111b455300123e525408580f3946460d191c451a454100575d0c5f4f165b445e4645066b0405155a5f0b0c0509445a0d5e5401120b090f5055581641481343116e5617510412046c5e0a5f02031b140654413a57101413565e116e141556463e58514d1d454841726531793e2d766d411f15415d11030c68170c55463b131d411f1542120c025c14104b11450f47510c6a120c50423b411d10421341125a400d540847134548416c6f4d1146025c430f5d5a0450424a416460266e222a7a712f656a31713d323e777f28702828131d411f15421439414114104b11450f47510c6a120b550803466e104b11463a1416410f124b144100085f553a4508125f51411f12591b04586c39104511414613144111154514454641130c07435f6b3914411115451445464113104511414613081241540b14060a004043581305034057135845115d0a0843134311480d030e16075e5b1119160f1b560a450051164b0f43110b42144b46455a44005c3a415d550c541238144b46460f1f164100080d396b1115451445464113104511415a1c4711505b5b135e4645525311580e0840145c11541746041f491a0b45151616506b075859006b160e0041590b56415b13101641563a57090f045d44480f02056c5304456a16511112085d5716194141555d0d546a165c0414085d574211485d135d0719154d140c151256444d11451143573e575c09513a150952420c5f063d14420854423a401c1604146d45184140151446565a0a5309033e575f0616415b0e14454645066b030f0d566f165900145a5a066a12135d00113e47491554463b131247115c0b6b04141352494d1145005a58046e411c44004a41524217501839585118421d45101216026c530958040847195f575c09511639075c423a560e095458046e510a573a100856474518414f131d414d49455d0b39004142044849461752085d503a401c16041f10414611056c570d58500b404858075a5c00423e005c463e435002410907136c460c5416461a1448114e45100405155a5f0b423a41455d04461238145846460f514559130355094316154b140203156c51015c08086c41135d1d4c144b4646525408580f48435c110e4215573a070247590a5f5c105a5116175b0a5a06035c14104b1116166c5713545411513a080e5d530019410156403e524017460008156c45165413395a504918154b142433357b6f2e7438461d1445584100593e41085717381148461d1446175c010942464f13140c45040b681308551238144b464615545857000a405147450842144b4645555909543e124a4404111b4216451200415700455c446c560d505b0e16451208475c000c4341131a416e6a4d144210085647421d413163773e72792c712b323e67753d653e227c7920787b451d4548411412450f46461d143e6e1d4513330f04441749113636706b227d7c207a3139357668316e25297e75287f154c1a45415d1c515b165a464e14455056115d0a08126817015e16085f5b00551238145846460f514559130355094316154b140203156c51015c08086c41135d1d4c144b4646525408580f48435c110e4215573a070247590a5f5c025c430f5d5a045043080e5d53000c46461d1416416a0646000715566f0b5e0f05561c415650116b06131341550b453e134051136e5c011c4c464f137130652939787138111b45100c12045e6b425805416e1448111b4513430f050e17451f41425a40045c6e425d01413c131e45164346475d155d50581642464f136f3a194141575b165f590a5501414d136735723e257f7d247f613a60203e356c742a7c202f7d1448111b4513453a461317451f41425a40045c6e425a040b04146d451f41416f1343110b42144b463e6c1845162509445a0d5e54011349463663733a722d2f767a356e61206c3139257c7d24782f461a1a4116094a555b415a1342004514145d141241470c5a11004914155415124616064542124914411208475c006e09125e584d1111115c0c154c0d420a463e075040085e5b161c45420050440c5e0f15131d41180e45");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function column_downloaded_by( $item ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d10415815035e6f46444600460b070c5617380a41");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function column_download_date( $item ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e460855104d1108154051151915415d11030c6817015e16085f5b00556a01551103466e104c11474013134611145814410f15565d3e160509445a0d5e54016b010715561738114846481413544110460b46454440066e020a5a510f45185b570639055244006e0709415900451d45471114155c440c5c044e1310084550086f42020e445e095e00026c500045504269454f4d131701501503141448111b4513590413131f5b16414813101641563a57090f045d44480f02056c500045503a520a140c52444d11121241400e455c08514d46455a44005c3a41575b165f590a55013905524400163c461a184116410c590041411a0b454c4114564014435b4513425d41");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function extra_tablenav( $which ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c52454e4114440a4146460e094115420d5d060e411a101e11060a5c56005d1541431502031f10414611056c570d58500b405e4645525c096e070f5f40044315581404141352494d113e391b1446775c0951424a416460266e222a7a712f656a31713d323e777f28702828131d410c0b4513030f0d561749113e391b1446755a125a09090057550111231f1418416665266b262a28767e316e35236b603e757a28752c28411a10580f4141575b165f590a550103056c521c16414f08145e0f386f396f46411310451141461314411109015d1346025f5116425c44525808565b0951031241525311580e0840165f3c3f451445464113104511414613144111155947000a045044455f000b560943525d045a02033e555909450414111408550847570d070f54553a57080a475113131516401c0a040e12035d0e07470e415d5003405e445f3e3a45114146131441111545144546411310451141460f5b11455c0a5a4510005f45000c434b0216410d0a155c1546085518451008154051151915416b222335681703580d125646466c154c14191a4112590b6e00144155181915416b222335681703580d125646466c194510040a0d6c560c5d1503411448111c4551060e0e131716540d0350400455125e145a585f0f0f155911466c514911123651090302471023580d125646461d1532642639227f79207f3539677139656a217b2827287d104c115e580f1b0e41410c5b0b586c3910451141461314411115451445464113104511415a0c44094115035b17030050584519414252580d6e530c5811031313511611450d564d5c0f11114d15033e555909450414131d414a154147000a0450440055415b131c4158461651114e41176f2274353d1452085d410046423b411a1043174142474d11546a035d0912044110580c41426c7324656e42520c0a155642426c414f130b411615165109030247550116415c131346110e4551060e0e1317595e11125a5b0f1143045810035c1117451f4142474d11546a035d09120441104b11464414144f11111651090302475501114f4614145f16154b143a394913140e54184a136331726a26782c232f676f317439326c702e7c742c7a454f411d10420d4e094340085e5b5b135e461c130f5b3c6b461314411115451445464113104511415a1c47045d5006405b6b6b131045114146131441111545144546410f43005d040547140f505800094715045f5506453e005a5815544747140c025c1143005d0405476b075859115117444140441c5d045b11520d5e54110e450a0455445e115d59435c11115c03144d46405a431654154e13103e7670316f4200085f440043463b131d414d4945150c083e52421750184e13103e7670316f4200085f440043463b1f14455059096b030f0d4755171148461a1404525d0a144746055a43155d001f09140f5e5b000f475d410c0e470f6c6c1314411115451445464113104511414613144111095a440d16415a564d1108154051151915416b222335681703580d125646466c154c144c461a135903194141575b165f590a550103056c521c16415b0e14456e7220603e41075a5c115413416e1448114e4510040a0d6c51104509094147410c1541431502031e0e02541539505b0d19154767202a24706445752835677d2f72614557090f045d443a58054675662e7c151e10121605511d5b411303555d194c4215573a050d5a550b453e005a5804426a015b12080d5c51016e0d09541641180e455d034e41504517430408476b144250176b06070f1b10424611056c59005f5402511741411a104317414750411343500b403a131256423a5200081b14465051085d0b0f12474204450e14141448111c454f45420c525e045604146c570d58500b4016465c131412410239505808545b11195b05026c5700453e07404708565b3a500412006c521c6e0e04595102451d451308070f52570043464a135304456a06411714045d443a441203416b08551d4c184541025f59005f1541131d5a111108550b070656423a561309464412110845101216026c530958040847195f52563a5300123e5243165806086c500045543a561c390e515a0052154e13130c505b04530014461f100254153950411343500b403a131256423a58054e1a184116560c46060a0414104c0a41005c460450560d144d46455e510b500603416b06435a104416460040104156130946443e5851451d451d41175101553e055f5d045f4145094542155b59161c5f05506b0654413a53170914436f065d08035d40126e5c011c454206415f10413e0f5714480a1541590408005455176e020a5a510f4546450945071341511c6e0c03415304191541590408005455176e020a5a510f45464914410705576f065d08035d4041180e454945420c525e045604146c570d58500b4016465c13511743001f6c410f584410514d46455e510b500603416b025d5c005a1115411a0b4515000a5f6b0044410d5b1715410e10044313074a6b085f410046160302471845150c075d550654473a57090f045d44161d414252580d6e5410400d091340104c0a411b130b5f3c3f45144546411310451141461314411115451445464113104511414613080e41410c5b0b4617525c10545c441e054311095a440d16415a56451941475a471254414d1441392676643e160509445a0d5e5401510139034a17381148464f484119150c471603151b10416e2623676f46555a125a0909005755016e031f146941181543124547085d6f044313074a1c41156a2271313d46575f125f0d09525004556a074d423b4d1314045d0d39524115595a1747454f411a104c1104055b5b41164600580005155654420a41590d0a5d0e450d444539041b104262040a5657151176095d000815141c456631256c772d78702b603a32246b643a752e2b727d2f111c450b5b5a4e5c4011580e080d396b111545144546411310451141461314411115451445464113104511415a0c440941150c52454e415a433a501314524d491111045809390046440d5e1315131d4117134504455a41505f105f154e1310005d593a551012095c42161148461a141a11530a460007025b184515000a5f6b0044410d5b171541524345150013475c0e436a0c50454f4148104142040a56571554514509454e41175110450909416b085515580945423e7475316a46025c430f5d5a045000023e5149426c414f130b4116460058000515565442115b4614135a1150065c0a46460f5f154508095d141750591051584446131e45150013475c0e436a0c5045484114124516414813101254590057110305131e4516415814144f115200403a13125642015015071b14455040115c0a143e5a5445184c58464704436a095b020f0f131e45165d495c4415585a0b0a425d414e1018111c46565812545c031c4541075a5c0016415b0e14456e7220603e41075a5c115413416e1448114e4510040a0d6c560c5d041513094115421550074b5f5455116e130340410d45464d144735247f75266541227a6735787b26604500055f1e03580d036c5d051d386f144546411310451141461314411115451445464113104511414613144111154514454641551e0b500c031f396b1115451445464113104511414613144111154514454641131045114146131441111545140348155a4409546c6c131441111545144546411310451141461314411115451445464113104511414675662e7c151e10121605511d5b411303555d194c4215573a050d5a550b453e005a5804426a015b12080d5c51016e0d09541407555949396f4641131045114146131441111545144546411310451141461314411115451445464113101e15161657564c0f451751030f194e4715523e055f5d045f413a520c0a044010033c6b4613144111154514454641131045114146131441111545144546411310451141317b71337415031a0c02410e1003550d48555d0d546a0c5047464d13713763203f6c7541180e4510040a0d6c560c5d04395a501211084510121605511d5b5604126c570e5d1d451636232d76733111252f6060287f763114030f0d566f0c556c6c131441111545144546411310451141461314411115451445464113104511414675662e7c151e10121605511d5b411303555d194c4215573a050d5a550b453e005a5804426a015b12080d5c51016e0d09541641180e450b5b6b6b13104511414613144111154514454641131045114146131441111545080a16155a5f0b1117075f41040c17480547465d0c400d41410f551c41105c164700124913143a76243268130758590013384648134c191149465a471254414d1441392676643e16070f5f51466c154c1443404112590b6e00144155181915416b222335681703580d0314694d111104580939075a5c006e0802401448111c451d4503025b5f451612035f5102455001135e465e0d0e590e110e43143e541d451336030d56531111270f5f51461d1532642639227f79207f3539677139656a217b2827287d104c115e580f1b0e41410c5b0b586c39104511414613144111154514454641131045114146131441111545145959115b40683b410f551449115c166b04141352494d1145075f583e575c09511646481316431151460f14025e400b404d4645525c096e070f5f5112111c451d451d41555f175400055b1c41155409583a00085f5516110015131007585900144c461a131416540d03504004551558144d4645555909543a41555d0d546a0c50423b410e0d45153e2176603a16530c5800413c1319450e414140510d54561151014141091042165a461752085d500b550803410e104d110815405115191541520c0a0468171158150a56133c111c45124346461410440c4142555d0d546e42400c120d5617381148460c1445575c09513e41155a440954463b130e4115530c58003d465d510854463b081404525d0a14425a0e43440c5e0f4645550d4450581642464f131403580d036813075859006b0c02466e104b1146441313411f154147000a045044005541481313410f12451a4542075a5c005f000b56144f1112591b0a16155a5f0b0f465d1349414c15181418465e0d3d6f114146131441111545144546411310450d4e1556580452415b396f464113104511414613144111154514455a5e4358151145105a4708535900145846491359164204121b14456e7220603e41075a5c115413416e1448111343140c083e52421750184e13103e7670316f4200085f440043463b1f14455059096b030f0d47551711484615124119154d1441392676643e16070f5f400443123814585b4114560c5d0441131247115c164700124913143a762432681307585900133846481319454d1d461b1446555a125a0909005755016e031f14145c0c15416b222335681703580d125646466c154312450f124055111941426c7324656e42500a110f5f5f045504026c56181668451d454f411a104c115e4647461454155f1403070d40555e115e583e3e411115451445464113104511414613145d425009510612415d5108545c4440510d5456116b030f0d4755170343465a505c134600580005156c560c5d15034106431146114d09035c1156095e001209140d5453110f455a5e435815110800131c411011135d160f035f5545184103505c0e111745500c15115f511c0b41085c5a040a175e145a58430d3d6f1141461314411115451445464113104511414613085e415d15140c00491359164204121b14456e7220603e41075a5c115413416e1448111c454f450f071b1042550e115d580e505100503a04181410580c41426c7324656e42520c0a155642426c4140151408424600404d46456c7720653a41575b165f590a550103056c521c163c461a1448114e4510040a0d6c560c5d041513094115421550074b5f5455116e130340410d45464d144735247f75266541227a6735787b26604500055f1e03580d036c5d051d386f144546411310451141461314411115451445464113104511414613144111154514454641551e0b500c031f396b1115451445464113104511414613144111154514454641131045114146131441111545140348155a4409546c6c131441111545144546411310451141461314411115451445464113104511414675662e7c151e10121605511d5b411303555d194c4215573a050d5a550b453e005a5804426a015b12080d5c51016e0d09541407555949396f4641131045114146131441111545144546411310451141461314411115451445464113101e15161657564c0f451751030f194e4715523e055f5d045f413a520c0a044010033c6b4613144111154514454641131045114146131441111545144546411310451141317b71337415031a0c02410e1003550d48555d0d546a0c5047464d13713763203f6c7541180e4510040a0d6c560c5d04395a501211084510121605511d5b5604126c570e5d1d451636232d76733111252f6060287f763114030f0d566f0c556c6c131441111545144546411310451141461314411115451445464113104511414675662e7c151e10121605511d5b411303555d194c4215573a050d5a550b453e005a5804426a015b12080d5c51016e0d09541641180e450b5b6b6b13104511414613144111154514454641131045114146131441111545080a16155a5f0b1117075f41040c17480547465d0c400d41410f551c41105c164700124913143a76243268130758590013384648134c191149465a471254414d1441392676643e16070f5f51466c154c1443404112590b6e00144155181915416b222335681703580d0314694d111104580939075a5c006e08024014481113431442070d5f1745105c46176b2674613e13030f0d5617381148461a1404525d0a144215045f5506450402140f410e0b5b085a160943103a5449461467045d5006404520085f55421d413163773e72792c712b323e67753d653e227c7920787b451d45595f0f1f0a41150f5c5a5f3c3f45144546411310451141461314411115451445464113104511414613080e41410c5b0b4617525c10545c4452580d1315590b150e111359031941426c7324656e42520c0a04146d450c5c4614550d5d12451d4503025b5f451612035f5102455001135e465e0d0e590e110e43143e541d4513240a0d13760c5d04151418416665266b262a28767e316e35236b603e757a28752c28411a105a0f5d495c4415585a0b0a686c41131045114146131441111545144546411310451141461314411115590b150e113e3a455807461b1408426a04461707181b1041500d0a6c52085d5016144c4647151055115d46505b145f414d1441070d5f6f03580d03401448111c454f45000e41550452094e1310005d593a520c0a04401004424142555d0d54154c141e46454055095402125650410c154d144100085f553e16070f5f513e58514269455b5c13143a76243268130758590013384648130f451612035f510245500113455c4114175e1145005a58045f540851455b411b100c421203471c4115530c58003d464759115d04416e144811134314424141120d4515070f5f513a16410c400903466e104c115e461752085d503e13110f155f55426c415c1310075859006f4208005e55426c5a465657095e1542080a16155a5f0b1117075f41040c1742144b4645555909543a41555d0d546a0c50423b411d1042134141131a41154600580005155654451f4141130a46111b4510030f0d565e045c04461d14460d1a0a44110f0e5d0e420a411b1349414c15005816030855184516070f5f51461108581441392676643e16070f5f4004431238144340415a431654154e13103e7670316f4200085f55426c414f131d414a154155090a3e524511590e1440145c1111124401044c0d5700453e055c5849111736712923226710217832327a7a22651506580c030f476f0c554120617b2c114e41431502031e0e154304005a4c1c4645066b060a08565e116e070f5f51126e510a430b0a0e52543a5d0e011114480a150c524d4602464217540f126c411254473a570408491317124102395e550f50520046424648131643114005464613545b116b101504416f06500f4e13130055580c5a0c15154151115e1341131d4118151e14410b005d5102541339505808545b1147455b41174715523e055f5d045f41480a06053e5455116e0015405d065f6a015511073e51493a5e030c56571519154259040800545517164d465451156e56104617030f476f104204146c5d05191c491442050d5a550b4546461a0f411558045a040104416f02430e134347410c15414315053e505c0c540f121e0a02526a025111390040430c560f39575515506a074d3a09035955064549461459005f54025117414d135700453e05464613545b116b101504416f0c55494f1f1446525c175709034613195e110709415100525d451c45420c525e045604146c53135e401547450712131402430e13436b0855154c141e46455254016e020a5a510f451558144112095a43480f02056c5304456a02460a13116c530958040847473e58514d144101135c45156e0802131d5a111108550b070656423a520d0f565a154215581404141352493a5c0414545149111108550b070656423a520d0f565a15421945100402056c53095804084714480a151814410b005d5102541339505808545b1147455b41524217501839465a084040001c45420c525e045604146c570d58500b40164648081041500d0a6c5514455d0a4616465c13511743001f6c5d0f455017470005151b10415c0008525304436a06580c030f4743491145075f583e5040115c0a141213195e111c460c0a6c3b154514454641131045114146131441111545144546411310451141460f5b11455c0a5a4510005f45000c434b0216410d0a155c1546085518451008154051151915416b2223356817015e16085f5b005550016b071f466e104c111d1a131c4158461651114e41176f2274353d14500e465b095b040204576f0748463b131d41171345150c083e52421750184e13103e7670316f42020e445e095e000256503e534c4269494645525c096e0013475c0e4346451d4540471317045d0d4113155c11113a7320323a14540a460f0a5c550554513a561c413c131945184103505c0e11121651090302475501165a460c0a5f0d0a155c15463e5618451632035f5102451526580c030f471749113636706b227d7c207a3139357668316e25297e75287f154c145a585d1c5f154508095d0a6c3b154514454641131045114146131441111545144546411310451141460f5b11455c0a5a4510005f45000c43075f584311095a440d16415a564d1145397471356a12015b12080d5c5101540539514d466c1558094541005f5c421148465657095e154247000a0450440055465d130b5f0f095a440d16416c554d1146275f584172590c510b1212141c456631256c772d78702b603a32246b643a752e2b727d2f111c450b5b5a4e5c4011580e080d396b111545144546411310451141461314411115451445464113104511415a0c440941150c52454e415a433a501314524d491111045809390046440d5e1315131d4117134504455a41505f105f154e1310005d593a551012095c42161148461a141a11530a460007025b184515000a5f6b0044410d5b171541524345150013475c0e436a0c50454f4148104142040a56571554514509454e41175110450909416b085515580945423e7475316a46025c430f5d5a045000023e5149426c414f130b4116460058000515565442115b4614135a1150065c0a46460f5f154508095d141750591051584446131e45150013475c0e436a0c5045484114124516414813101254590057110305131e4516415814144f115200403a13125642015015071b14455040115c0a143e5a5445184c58464704436a095b020f0f131e45165d495c4415585a0b0a425d414e1018111c464e145e0f386f14454641131045114146131441111545084a15045f5506455f6b3914411115451445464113104511414613081241540b140c025c115c0a50053940510d5456116b030f0d475517134115474d0d54084752090900470a455d0400470f415c5417530c085b130315494153434c4101451d1455161908125b0d4e1543550f0f386f14454641131045114146131441111545080c0811464445451816560943534011400a08431346045d14030e165d0e450d444539041b104277080a4751131619456335253e707c2c742f326c602469613a702a2b207a7e451841590d164152590447165b43514511450e081e4704525a0b5004141811100c555c44555d0d455017510144415d5108545c44111412454c09515844075f5f04455b465f5107450e47144a586c39104511414613144111154514454641130c0411020a5247120c170450014b0f56474859534650550f5250096b030f0d47551713410f57094352540b57000a3e555909450414111412454c09515844075f5f04455b0a5652150a15064117150e410a45410e0f5d4004430e45590414065a5e48450e16091455414d5e145959115b404558074e131508424600404d46456c7720653a41555d0d45501713384f411a1000520909131341555c164409071809100b5e0f0308135a110a5b1645585d0c400d414139561c41136700590a100413760c5d150341164d116235773a252d7a752b653e32766c356e712a79242f2f1319450e5f5a4044005f1506580415120e12004b3e05525a0254593a561012155c5e471112124a58040c1708551701085d0a4500111e130411491555441d465643485e135f5a1c4711505b5b084a075f3e3a4511414613144111154514455a4e5759130f6c6c3e3e41111545144546410f0f155911464e14");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function wpc_get_items_per_page( $attr = false ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("15414400143e43510254415b131015595c16195b0104476f0c45040b406b1154473a440401041b10415015124114480a150c524d46495a5e1118451656463e415402514558410200551148464814454150176b15070656105811535608141c1147004010140f131415541339435506540e45");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 function wpc_set_pagination_args( $attr = false ) {$cf86af25992f0f32 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f4250116b1507065a5e044508095d6b004352161c45420047441711485d13");if ($cf86af25992f0f32 !== false){ return eval($cf86af25992f0f32);}}
 } $excluded_clients = "'" . implode( "','", $this->cc_get_excluded_clients() ) . "'"; $ListTable = new WPC_Clients_List_Table( array( 'singular' => __( 'file_download', WPC_CLIENT_TEXT_DOMAIN ), 'plural' => __( 'file_downloads', WPC_CLIENT_TEXT_DOMAIN ), 'ajax' => false )); $per_page = $ListTable->wpc_get_items_per_page( 'users_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'file_title' => 'file_title', 'download_date' => 'download_date', ) ); $ListTable->set_columns(array( 'file_icon' => '', 'file_title' => __( 'File Title', WPC_CLIENT_TEXT_DOMAIN ), 'download_date' => __( 'Download', WPC_CLIENT_TEXT_DOMAIN ), 'downloaded_by' => __( 'Downloaded By', WPC_CLIENT_TEXT_DOMAIN ) )); $items_count = $wpdb->get_var( "SELECT COUNT( dl.id )
    FROM {$wpdb->prefix}wpc_client_files_download_log dl
    LEFT JOIN {$wpdb->users} u ON dl.client_id = u.ID
    LEFT JOIN {$wpdb->prefix}wpc_client_files f ON dl.file_id = f.id
    WHERE 1=1 " . $where_manager. " " . $where_search . " " . $where_filter ); $download_log = $wpdb->get_results( "SELECT dl.download_date, u.user_login as username, f.*
    FROM {$wpdb->prefix}wpc_client_files_download_log dl
    LEFT JOIN {$wpdb->users} u ON dl.client_id = u.ID
    LEFT JOIN {$wpdb->prefix}wpc_client_files f ON dl.file_id = f.id
    WHERE 1=1 ". $where_search . " " . $where_filter . " " . $where_manager . "
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", {$per_page}
    ", ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $download_log; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); if ( isset( $_GET['updated'] ) ) { ?><div id="message" class="updated wpc_notice fade"><p><?php echo urldecode( $_GET['dmsg'] ); ?></p></div><?php
} ?>
<style>
    .fancybox-title {
        display: none;
    }

    .column-file_icon {
        width: 50px;
    }

    .column-file_title {
        width: 50%;
    }

    .column-downloaded_by,
    .column-download_date {
        width: 25%;
    }

</style>

<div class='wrap'>

    <?php echo $this->get_plugin_logo_block() ?>

    <div class="wpc_clear"></div>

    <div id="wpc_container">

        <?php echo $this->gen_tabs_menu( 'content' ) ?>

        <span class="wpc_clear"></span>

        <?php
 if ( isset( $_GET['msg'] ) ) { switch( $_GET['msg'] ) { case 'r': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Files assigned to another category!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'd': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'File(s) are Deleted.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'ad': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been added', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'up': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been uploaded!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'as': echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'The file has been uploaded!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'm': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'The file size more than allowed!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'There was an error uploading the file, please try again!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er_as': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'There was an error assign the file, please try again!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'er_as2': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Some error with assigning permission for file.', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; case 'ne': echo '<div id="message" class="error wpc_notice fade"><p>' . __( 'Error: File not exist!', WPC_CLIENT_TEXT_DOMAIN ) . '</p></div>'; break; } } ?>

        <div class="wpc_tab_container_block">

            <form action="" method="get" name="wpc_file_form" id="wpc_file_form">
                <input type="hidden" name="page" value="wpclients_content" />
                <input type="hidden" name="tab" value="files_downloads" />
                <?php $ListTable->search_box( __( 'Search Files' , WPC_CLIENT_TEXT_DOMAIN ), 'search-submit' ); ?>
                <?php $ListTable->display(); ?>
            </form>

        </div>


    <script type="text/javascript">
        var site_url = '<?php echo site_url();?>';
        var request_uri = "<?php echo $_SERVER['REQUEST_URI'];?>";

        jQuery( document ).ready( function() {

            //change filter
            jQuery( '#change_filter' ).change( function() {
                if ( '-1' != jQuery( '#change_filter' ).val() ) {
                    var filter = jQuery( '#change_filter' ).val();
                    jQuery( '#select_filter' ).css( 'display', 'none' );
                    jQuery( '#select_filter' ).html( '' );
                    jQuery( '#select_filter2' ).css( 'display', 'none' );
                    jQuery( '#select_filter2' ).html( '' );
                    jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                    jQuery.ajax({
                        type: 'POST',
                        url: '<?php echo get_admin_url() ?>admin-ajax.php',
                        data: 'action=wpc_get_options_filter_for_files_download_log&filter=' + filter,
                        dataType: 'html',
                        success: function( data ){
                            jQuery( '#select_filter' ).html( data );
                            jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                            jQuery( '#select_filter' ).css( 'display', 'block' );
                        }
                    });
                } else {
                    jQuery( '#select_filter' ).css( 'display', 'none' );
                    jQuery( '#select_filter2' ).css( 'display', 'none' );
                    jQuery( '#select_filter' ).html( '' );
                    jQuery( '#select_filter2' ).html( '' );
                }
                return false;
            });

            jQuery( '#select_filter' ).change( function() {
                if ( '-1' != jQuery( '#select_filter' ).val() ) {
                    var filter = jQuery( '#change_filter' ).val();
                    var select_filter = jQuery( '#select_filter' ).val();

                    jQuery( '#select_filter2' ).css( 'display', 'none' );
                    jQuery( '#select_filter2' ).html( '' );
                    jQuery( '#load_select_filter' ).addClass( 'wpc_ajax_loading' );
                    jQuery.ajax({
                        type: 'POST',
                        url: '<?php echo get_admin_url() ?>admin-ajax.php',
                        data: 'action=wpc_get_options_filter_for_files_download_log&filter=' + filter + '&select_filter=' + select_filter,
                        dataType: 'html',
                        success: function( data ){
                            jQuery( '#select_filter2' ).html( data );
                            jQuery( '#load_select_filter' ).removeClass( 'wpc_ajax_loading' );
                            jQuery( '#select_filter2' ).css( 'display', 'block' );
                        }
                    });
                } else {
                    jQuery( '#select_filter2' ).css( 'display', 'none' );
                    jQuery( '#select_filter2' ).html( '' );
                }
                return false;
            });


            //filter
            jQuery( '#filtered' ).click( function() {
                if ( '-1' != jQuery( '#change_filter' ).val() && '-1' != jQuery( '#select_filter' ).val() && '-1' != jQuery( '#select_filter2' ).val() ) {
                    var req_uri = "<?php echo preg_replace( '/&downloaded_by=[a-z0-9]+|&file=[a-z0-9]+|&paged=[0-9]+|&filter=[a-z\_]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                    //if ( in_array() )
                    switch( jQuery( '#change_filter' ).val() ) {
                        case 'downloaded_by':
                            window.location = req_uri + '&downloaded_by=' + jQuery( '#select_filter' ).val() + '&file=' + jQuery( '#select_filter2' ).val() + '&filter=downloaded_by';
                            break;
                        case 'file':
                            window.location = req_uri + '&file=' + jQuery( '#select_filter' ).val() + '&downloaded_by=' + jQuery( '#select_filter2' ).val() + '&filter=file';
                            break;
                    }
                }
                return false;
            });


            jQuery( '#cancel_filter' ).click( function() {
                var req_uri = "<?php echo preg_replace( '/&downloaded_by=[a-z0-9]+|&file=[a-z0-9]+|&filter=[a-z\_]+|&msg=[^&]+/', '', $_SERVER['REQUEST_URI'] ); ?>";
                window.location = req_uri;
                return false;
            });

        });
    </script>

</div>