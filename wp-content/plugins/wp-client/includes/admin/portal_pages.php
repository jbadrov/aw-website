<?php
if ( !current_user_can( 'wpc_admin' ) && !current_user_can( 'administrator' ) && !current_user_can( 'view_others_clientpages' ) && !current_user_can( 'edit_others_clientpages' ) ) { if ( current_user_can( 'read_hubpage' ) || current_user_can( 'edit_hubpage' ) ) $adress = 'admin.php?page=wpclients_content&tab=hub_pages'; else $adress = 'admin.php?page=wpclients_content&tab=files'; do_action( 'wp_client_redirect', get_admin_url() . $adress ); } global $wpdb; if ( isset($_REQUEST['_wp_http_referer']) ) { $redirect = remove_query_arg(array('_wp_http_referer' ), wp_unslash( $_REQUEST['_wp_http_referer'] ) ); } else { $redirect = get_admin_url(). 'admin.php?page=wpclients_content'; } if ( isset( $_GET['action'] ) ) { switch ( $_GET['action'] ) { case 'trash': $pp_ids = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_portal_page_trash' . $_REQUEST['id'] . get_current_user_id() ); $pp_ids = (array) $_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( $this->custom_titles['portal']['p'] ) ); $pp_ids = $_REQUEST['item']; } if ( count( $pp_ids ) ) { foreach ( $pp_ids as $pp_id ) { $type = $wpdb->get_var( $wpdb->prepare( "SELECT post_status FROM {$wpdb->posts} WHERE ID = '%d'", $pp_id ) ); if( $type ) add_post_meta( $pp_id, 'wpc_hubpage_old_status', $type ) ; $wpdb->update( $wpdb->posts , array( 'post_status' => 'trash' ), array( 'ID' => $pp_id ) ); } do_action( 'wp_client_redirect', add_query_arg( 'trashed', count( $pp_ids ), $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; break; case 'untrash': $pp_ids = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_portal_page_untrash' . $_REQUEST['id'] . get_current_user_id() ); $pp_ids = (array) $_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( $this->custom_titles['portal']['p'] ) ); $pp_ids = $_REQUEST['item']; } if ( count( $pp_ids ) ) { foreach ( $pp_ids as $pp_id ) { $new_status = get_post_meta( $pp_id, 'wpc_hubpage_old_status', true ) ; $wpdb->update( $wpdb->posts , array( 'post_status' => $new_status ), array( 'ID' => $pp_id ) ); } do_action( 'wp_client_redirect', add_query_arg( 'untrashed', count( $pp_ids ), $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; break; case 'delete': $pp_ids = array(); if ( isset( $_REQUEST['id'] ) ) { check_admin_referer( 'wpc_portal_page_delete' . $_REQUEST['id'] . get_current_user_id() ); $pp_ids = (array) $_REQUEST['id']; } elseif( isset( $_REQUEST['item'] ) ) { check_admin_referer( 'bulk-' . sanitize_key( $this->custom_titles['portal']['p'] ) ); $pp_ids = $_REQUEST['item']; } if ( count( $pp_ids ) ) { foreach ( $pp_ids as $pp_id ) { $user_id = $wpdb->delete( $wpdb->usermeta, array( 'meta_key' => 'wpc_cl_hubpage_id', 'meta_value' => $pp_id ) ) ; wp_delete_post( $pp_id ); $this->cc_delete_all_object_assigns( 'portal_page', $pp_id ); } do_action( 'wp_client_redirect', add_query_arg( 'deleted', count( $pp_ids ), $redirect ) ); exit; } do_action( 'wp_client_redirect', $redirect ); exit; break; } } if ( !empty( $_GET['_wp_http_referer'] ) ) { do_action( 'wp_client_redirect', remove_query_arg( array( '_wp_http_referer', '_wpnonce'), wp_unslash( $_SERVER['REQUEST_URI'] ) ) ); exit; } $visible_status = array( 'trash', 'publish', 'future', 'draft', 'pending', 'private' ); $where_status = ''; if( !empty( $_GET['filter_status'] ) && in_array( $_GET['filter_status'], $visible_status ) ) { $where_status = " AND p.post_status = '" . esc_sql( $_GET['filter_status'] ) . "'"; } else { $for_all_visible_status = $visible_status; array_shift( $for_all_visible_status ); $where_status = " AND p.post_status IN ('" . implode( "','", $for_all_visible_status ) . "') "; } $where_clause = ''; if( isset( $_GET['s'] ) && !empty( $_GET['s'] ) ) { $search_text = strtolower( trim( esc_sql( $_GET['s'] ) ) ); $where_clause = " AND p.post_title LIKE '%" . $search_text . "%'"; } $where_manager = ''; if( current_user_can( 'wpc_manager' ) && !current_user_can( 'administrator' ) ) { $manager_id = get_current_user_id(); $manager_clients = $this->cc_get_assign_data_by_object( 'manager', $manager_id, 'client' ); $manager_groups = $this->cc_get_assign_data_by_object( 'manager', $manager_id, 'circle' ); $clients_groups = array(); foreach ( $manager_groups as $group_id ) { $clients_groups = array_merge( $clients_groups, $this->cc_get_group_clients_id( $group_id ) ); } $manager_all_clients = array_unique( array_merge( $manager_clients, $clients_groups ) ); $groups_clients = array(); foreach ( $manager_clients as $client_id ) { $groups_clients = array_merge( $groups_clients, $this->cc_get_client_groups_id( $client_id ) ); } $manager_all_groups = array_unique( array_merge( $manager_groups, $groups_clients ) ); $post_of_clients = $this->cc_get_assign_data_by_assign( 'portal_page', 'client', $manager_all_clients ); $post_of_groups = $this->cc_get_assign_data_by_assign( 'portal_page', 'circle', $manager_all_groups ); $cat_of_clients = $this->cc_get_assign_data_by_assign( 'portal_page_category', 'client', $manager_all_clients ); $cat_of_groups = $this->cc_get_assign_data_by_assign( 'portal_page_category', 'circle', $manager_all_groups ); $all_cats = array_unique( array_merge( $cat_of_clients, $cat_of_groups ) ); $posts_of_cats = $wpdb->get_col( "SELECT p.ID FROM {$wpdb->posts} p INNER JOIN {$wpdb->postmeta} pm ON ( p.ID = pm.post_id AND pm.meta_key = '_wpc_category_id' AND pm.meta_value IN ('" . implode( "','", $all_cats ) . "') ) WHERE p.post_type = 'clientspage'" ); $manager_all_post = array_unique( array_merge( $post_of_clients, $post_of_groups, $posts_of_cats ) ); $where_manager = " AND p.ID IN ('" . implode( "','", $manager_all_post ) . "')" ; unset( $manager_clients, $manager_all_clients, $manager_groups, $manager_all_groups, $clients_groups, $groups_clients, $post_of_clients, $post_of_groups, $cat_of_clients, $cat_of_groups, $all_cats, $posts_of_cats, $manager_all_post ); } $where_cat = ''; if( isset( $_GET['wpc_pp_category'] ) && (int)$_GET['wpc_pp_category'] ) { $search_text = (int)$_GET['wpc_pp_category']; $where_cat = " AND cppc.cat_id = '" . $search_text . "'"; } $where_date = ''; $m = ( isset( $_GET['m'] ) ) ? (int)$_GET['m'] : 0 ; if ( 0 < $m && 6 == strlen( $m ) ) { $year = substr( $m, 0, 4 ); $month = substr( $m, 4, 6 ); $next_month = $month + 1; $where_date = " AND p.post_modified > '{$year}-{$month}-01 00:00:00' AND p.post_modified < '{$year}-{$next_month}-01 00:00:00'"; } $order_by = 'p.ID'; if ( isset( $_GET['orderby'] ) ) { switch( $_GET['orderby'] ) { case 'date' : $order_by = 'p.post_modified'; break; } } $order = ( isset( $_GET['order'] ) && 'asc' == strtolower( $_GET['order'] ) ) ? 'ASC' : 'DESC'; if( ! class_exists( 'WP_List_Table' ) ) { require_once( ABSPATH . 'wp-admin/includes/class-wp-list-table.php' ); } class WPC_Portalpages_List_Table extends WP_List_Table { var $no_items_message = ''; var $sortable_columns = array(); var $default_sorting_field = ''; var $actions = array(); var $bulk_actions = array(); var $columns = array(); function __construct( $args = array() ){$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("154155170112130d4546113943551342503a551701121b1041501301401841504717551c4e4114430c5f06135f55131615580a45393e1b10425815035e134d116235773a252d7a752b653e32766c356e712a79242f2f1319491146165f4113505942145858416c6f4d11460f47510c421249143236226c7329782428676b35746d316b21292c72792b11484a1313005b541d13455b5f1356045d1203131d41180e4510110e08401d5b5f0e395a40045c463a59001512525700115c4617551356463e13150a14415109163c461d14461112451a45393e1b10425f0e1213520e445b011a424a416460266e222a7a712f656a31713d323e777f28702828131d5a11450446000815090a3a6e02095d4715434006404d464552420242414f0814");if ($c56f782fb29aaca8 !== false){ eval($c56f782fb29aaca8);}}
 function __call( $name, $arguments ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d1006500d0a6c411254473a521008026c511743001f1b14004347044d4d464547580c424d46175a005c50451d494645524202440c035d4012111c5e14");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function prepare_items() {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541570a0a145e5e16115c461740095846480a0203156c530a5d140b5d4749180e45100d0f0557550b115c46524613504c4d1d5e4645405f174500045f51410c1541400d0f121e0e02541539405b13455407580039025c5c105c0f151b1d5a1111115c0c154c0d6f065e0d135e5a3e59500450001412130d45501314524d491111065b09130c5d434911450e5a5005545b491441150e414404530d03131d5a11");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_default( $item, $column_name ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c524d4608404300454946175d1554583e1441050e5f45085f3e085259041168451d454f41481017541513415a41155c1151083d4117530a5d140b5d6b0f50580014385d414e10005d1203134f414350114117084114175e111c46");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function no_items() {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("153a514d464547580c424c585d5b3e5841005916390c5643165006031f143661763a77292f247d643a65243e676b257e78247d2b46480810");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function set_sortable_columns( $args = array() ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("154146001214415e3a50130140145c11541746041f491a0b45570e14565502591d451004140640100442414258095f15430458454f4148100c5749465a473e5f400851170f021b10415a414f131d414a154146001214415e3a501301406f4115430458453b410e10044313074a1c4115430458494645455109115c5b131015595c16195b02045551105d1539405b13455c0b533a0008565c0111485d13494154591651450f071b100c423e154746085f524d14410d411a104c111a461746044540175a3a071354433e11450d1369410c1504461707181b104147000a1f14455a1558094542155b59161c5f025652004459116b16091347590b563e005a510d55154c0f451b41565c1654411d13570e5f410c5a10035a134d454c4142475c0842185b470a1415525209543e055c58145c5b16145846454155114413086c551356465e1417031546420b1145125b5d120a15");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function get_sortable_columns() {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f425a174004040d566f065e0d135e5a120a15");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function set_columns( $args = array() ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c524d46025c450b4549461740095846480a07130d586f0452150f5c5a12111c451d451d411751175612460e14004347044d3a0b04415700194107414600481d4513060446130d5b11465a5a5a11444145401c16040e120659040558560e4917451b5b41411a1c45150014544741180e45494542155b59161c5f055c58145c5b1614584645524202425a4641511544470b144112095a435e11");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function get_columns() {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f525a09410808120810");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function set_actions( $args = array() ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541400d0f121e0e0452150f5c5a1211084510041406400b4543041246460f1111115c0c155a13");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function get_actions() {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f5056115d0a08120810");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function set_bulk_actions( $args = array() ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541400d0f121e0e07440d0d6c5502455c0a5a16465c131404430615081413544110460b464547580c425a46");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function get_bulk_actions() {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f5340095f3a070247590a5f125d13");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_cb( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d101641130f5d4007191542080c0811464445451816560943525d00570e040e4b12455f000b560943584100593e3b431346045d14030e16444217451b5b414d13140c45040b681308551238144c5d41");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_title( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e4645525311580e0840145c11541746041f491a0b455807461b1408424600404d46456c7720653a41555d0d4550176b161200474516163c461a1447171542401707125b17450c5c46176b2674613e13030f0d4755176e1212524014421238144c461a13590311494650411343500b403a131256423a5200081b144654510c403a09155b5517423e055f5d045f41155502031214104c1148464814455056115d0a08126817105f15145247091668450945415d52100d4304000e160055580c5a4b1609430f155006030e431152590c510b12126c530a5f15035d40475056115d0a085c465e114300155b1208550842144b46455a44005c3a415a50466c154b1442403e44400b5e0f05560946111b45431539024155044504395d5b0f52504d14421111506f155e131252583e415402513a130f474204420941131a41155c1151083d465a54426c4148135304456a06411714045d443a441203416b08551d4c144c464f1317436e16166c5c1545453a460000044155170c46461d14144359005a060905561845461139465a125d54165c4d46456c6320633723616f46637034612035356c653778463b131d4118154b144244414759115d045b1113411f1500470639004744171941396c1c4116670047110913561011590815135d155458455217090c13440d544132415512591249143236226c7329782428676b35746d316b21292c72792b1148461a144f11124714455846131e456e3e4e1313335446115b1703461f1032612239707828747b316b312339676f217e2c277a7a4118154b14425a4e520e420a4142525715585a0b473e4105565c004504416e145c11125955450e135656581300025e5d0f1f450d445a16005455584611055f5d045f41166b06090f47550b4547075040085e5b5850000a0447554358055b14144f11110c40000b3a145901163c461d1446176a12440b090f5055581641481343116e5617510412046c5e0a5f02031b14464645066b1509134751096e110754513e55500951110346131e4515081256593a165c011338464f135700453e05464613545b116b101504416f0c55494f131d411f1542123a11116c5811451139415107544700465841411d1010430d035d570e55504d1412163e465e165d00155b1c41156a3671373024616b42632437667132656a30662c413c13194518414813134311410c4009035c1117451f410340573e504111464d463e6c18451625035f51155415115c0c15415a44005c411656460c505b005a110a18141c456631256c772d78702b603a32246b643a752e2b727d2f111c451d4548411412450f46461d143e6e1d451321030d5644001131034159005f500b40091f461f1032612239707828747b316b312339676f217e2c277a7a4118154b14425a4e520e420a411b13494154591651451d415a5645194105464613545b116b101504416f06500f4e131304555c116b0a12095642166e020a5a510f4545045300154613194518411d13100052410c5b0b153a1455015815416e145c11125955450e1356565813110940404f415d150b150912470d42114f46175d1554583e130c02466e104b114640525715585a0b090002084712454508125f515c1312451a450312506f044515141b143e6e1d4513200208471011590815135d15545842144c4648131e4516435814144f116a3a1c454124575911164d466464226e76297d2028356c6420693539777b2c707c2b144c464f1317591e0058140f41155406400c090f406b4255040a5640041668450945415d52100d4304000e160055580c5a4b1609430f155006030e431152590c510b12126c530a5f15035d40475056115d0a085c4742044209405a505c16154b14410f15565d3e1608021469411f1542123a11115d5f0b52045b14144f1142156b0614045244006e0f095d57041915424315053e435f1745000a6c440056503a401707125b17451f41425a40045c6e425d01413c131e455604126c57144347005a1139144055176e08021b1d4118154b1442403e44403a591512436b135453004600145c14104b1114145f510f525a01514d4616436f105f120a5247091915416b3623336575376a46347665347466316b303428146d4518414f131a41161745400c120d560d47164148135112526a0440111449136f3a1941417e5b175415115c0c15415a44005c41125c1415595045601707125b1749113636706b227d7c207a3139357668316e25297e75287f154c144c464f13174711415814144f116a3a1c45413541511659464a136331726a26782c232f676f317439326c702e7c742c7a454f411d10420d4e070d135a1148455d034e41504517430408476b144250176b06070f1b171241023952500c585b3a411603136c5c0a560808141d4118151e144115025b550850415b135d126e4616584d4f410c104259151243475b1e1a42145f46465b4411415b491c135a111106411714045d443a44130a1309411546065c000b00131e45153e3576663774673e132d3235636f2d7e32321469411f15416b3623336575376a46347665347466316b303428146d5e114516436b114350135d00113e464209115c465451156e5401590c083e46420919410846580d1d120450080f0f1d400d415e1143573e5056115d0a085c4155095e060f5d12115052006b0b070c560d155e131252583e4154025143160054553a58055b14144f11110c40000b3a145901163c461d144617470052001404416f10430d5b14144f114017580008025c540019414250411343500b403a13135f104c11485d13494154591651451d411740156e111456420854423a41170a410e10025415394351135c54095d0b0d4913140c45040b681308551238144c5d414e10415002125a5b0f426e42420c0316146d450c41410f5541594700525844461d1041411139434604475c00433a13135f104b1643465c5a025d5c065f583a4641551144130813570e5f530c46084e4314104b111216415d0f45534d143a394913123c5e1446445d0d5d1507514514041e5c0a5606035719085f15105a01031313440d5441145c5804115a0314401541475f45411303455d044615115c0c1541435102544f46705b0f455c0b410059431f1032612239707828747b316b312339676f217e2c277a7a41181945101216026c530958040847195f524016400a0b3e4759115d04156813025d5c005a11413c681716163c461a144f1112471d5e3a46130e42114f466c6b49111235460010085647421d413163773e72792c712b323e67753d653e227c7920787b451d454841140c4a505f4108141c1147004010140f13431543080847524916105410164644011416164d461408030f0904140d1404550d47410e15471a1159455a440a15150e17451f41425a40045c6e425d01413c131e451647075040085e5b5851010f15110e42114f461b144911124214445b41175911540c3d14400845590013384648130f4515081256593a16410c400903466e105f11464e14144f116a3a1c45410f5c101158150a56134d116235773a252d7a752b653e32766c356e712a79242f2f1319451f41411a134118154b14425a4e520e591e035814184115410d5d164b5f415f126e0005475d0e5f464d1441070247590a5f12461a14480a15");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function extra_tablenav( $which ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c52454e4114440a4146460e094115420d5d060e411a101e11060a5c56005d1541431502031f10414611056c570d58500b405e464547580c424c585e5b0f455d166b01140e43540a460f4e1313025d5c005a11151152570016414f081445525411510209135a5516115c461743115557480a0203156c420042140a474749111736712923226710065015395a504d3c3f45144546411310451141461314411115451445460252443a5f000b56396b1115451445464113104511414613144177672a79451d45444001534c58434604575c1d491216026c5309580408476b115e4711550939115257006e02074751065e470c51166b6b131045114146131441111545144546417c6221743346716d415254116b0b070c5610246222441f14206367246d3a27411a0b45570e14565502591d451006071556570a4308034014004215415f001f5c0d1406501503545b1348154c141e464552420242415b13551343541c1c45410c5644046e0a034a13410c0b45133a1111506f06501503545b13486a0c50424a41145d0045003945550d445042145858411753044504015c46186a1206551139085717381d4141435b12456a114d150346130d5b1146055f5d045f41164404010414104c0a4142435b1245464509450104476f155e1212401c411554175316464808100c5749461b1402444717510b123e464300433e05525a4911120450080f0f5a43114300125c4646111c4548194602464217540f126c411254473a5704084913171241023952500c585b42144c464813164311404e135d124250111c4542115c431142414f131247111400591512181b1041410e1547474118154c144c461a13450b4204121b1445525411510209135a55166a450d564d3c111c5e1406090f47590b44045d1349415853451c4505144142005f1539464704436a06550b4e41144715523e0b525a0056501713454f411516451002134146045f413a411603136c53045f49461455055c5c0b5d16121352440a4346461a1448114e4510130f125a5209543e0b52460a544745094500005f43000a41425e550f505200463a0f05130d455604126c57144347005a1139144055176e08021b1d5a111106580c030f476f0c5512460e14454645066b060a08565e111c5f05506b0654413a55161508545e3a550012526b03486a0a560f0302471845160c075d55065447421845420c525e045604146c5d051d154257090f045d444211485d13100c505b045300143e54420a441115130941154215573a050d5a550b454c5850573e5650116b0415125a570b6e050747553e534c3a5b070c0450444d11460b525a00565017134946455e510b500603416b0855194513060f13505c0016414f0814075e470055060e411b10415c0008525304436a02460a131140100442414254460e44453a5d014648134b45150002576b025d5c005a11465c131412410239505808545b11195b05026c5700453e01415b14416a06580c030f47433a58054e131006435a10443a0f0513195e1145055f5d045f413a5d0115410e10044313074a6b0c544702514d4645505c0c540f126c5d05421945100402056c53095804084714480a15181441050d5a550b453e0f5747410c1504461707186c450b581013561c411556095d0008156c590142414f0814075e470055060e491314155e12124014004215415f001f5c0d14155e1212131d414a154157041204545f17483e0f57145c111106551103065c421c6a460552403e585142695e464546430043123950551554520a461c465c131845581215564049111106551103065c421c6e0802131d4118155a14411111506f065d08035d404c0f56066b0203156c51164208015d6b055041046b071f3e5c520f5402121b1446415a1740040a3e435102543e05524004565a174d424a411753044504015c46186e5c01184541025f59005f1541131d410b1504461707181b195e1145134051136e5c0147455b41174715523e055f5d045f41480a06053e5455116e0015405d065f6a015511073e51493a5e030c565715191542440a1415525c3a41000156134d1111155b16124c0d79211d4141505808545b1113454f5a1314104204146c5d054215581404141352493a5c0414545149111110470014126c53044504015c46181d1541411603136c590142414f08144556470a4115153e505111540609414d410c154d140c151256444d114505524004565a174d3a0f0513194518415913101641563a57090f045d44480f02056c5304456a0447160f065d6f015015076c56186e5a075e0005151b1042410e1447550d6e450453003902524400560e144a134d111106551103065c421c6e08021f1446525c17570903461319450b4107414600481d4c0f454206415f104112395a50410c15414315053e505c0c540f121e0a02526a025111390040430c560f39575515506a074d3a090359550645494614440e434104583a16005455421d4142435b1245185b7d214a4114530c43020a561341180e451002140e4640166e0802130941504717551c390c5642025449461753135e4015473a05004755025e131f1f144556470a4115153e5a5445185a465a524119150c473a071341511c19414254460e4445166b0c02411a1043174156130841525a105a114e411757175e1416406b0855154c144c46075c420050020e1b144556470a4115153e5a54455012461753135e40156b0c02411a101e1145134051136e5c0147455b415242175018395e511356504d1441131256423a5805151f14454645066b060a08565e111c5f05506b0654413a53170914436f065d08035d40126e5c011c454206415f10413e0f571448111c5e1418460855104d1108156c551343541c1c4542144055176e08024014481113431455465d13530a440f121b1445444600463a0f0540104c11484617411254473a5d0115410e10044313074a6b145f5c1441004e411745165413395a5012111c5e140c00411b100c423e07414600481d4510060a08565e116e08024014481113431455465d13530a440f121b144552590c510b123e5a54161148461a141a11530a460007025b184515020a5a510f456a0c50164600401041520d0f565a156e5c01144c461a1359031149465a5a3e504717551c4e41175309580408476b0855194510101504416f0c5512461a1448114e4510130f125a5209543e0b52460a5447450945121346555e111c464e141c115c031c45474545591658030a566b0c50470e51174648134b45440f155640491111155b16121268140e54183b131d5a11560a5a110f0f46555e111c46174208425c075800390c52420e5413460e1407505916515e461c1359031941471b1408424600404d4645435f164512461a1447171544510816154a1845151109404012111c451d454f414810105f1203471c411556044000010e415900423a425851186c154c0f45050e5d440c5f140308141c1148454945595f3e3a4511414613144111154514455a12565c005215465d550c5408474315053e43403a52001256530e434c470a686c411310451141461314411115451445465d5c4011580e081342005d40000947445f0f0f155911466c51491112335d001141525c091102074751065e470c511646461f1032612239707828747b316b312339676f217e2c277a7a41180e450b5b5a4e5c4011580e080d396b111545144546411310451141461314410d0a155c154645504517430408476b171108455d161504471845153e2176603a164215573a16116c53044504015c46181668451d455941176f2274353d144311526a15443a05004755025e131f1469410b1542135e46075c420050020e1b1445525411510209135a5516110015131002504100530a14181319454a41590d396b1115451445464113104511414613144111154514454641130c0a41150f5c5a4147540941005b430f0f155911465657095e154157041204545f17483a415055156e5c011338465e0d12450d5e165b444158534d144105144142005f153945145c0c154157041204545f17483a415055156e5c0113384648134b450e5f4640510d54561151015b434055095402125650430d0a155c15461c130f5b0f5d59435c111150065c0a4645505111540609414d3a165604403a08005e55426c41590d084e5e45115d0a085f141c683b41461314411115451445464113104511414613145d0e450d44451b410c0e683b4146131441111545144546410f1f16540d0350405f3c3f451445464113104511414613085e415d15396f4612465208581539514115455a0b1c45393e1b104277080a47511316154c184541034644115e0f411f1446575c094000143e525311580e0814184157540947004a4152421750184e131308551245095b4646435f16454c1746511348181641070b0847174518414f08141c11");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_clients( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e46454643004312460e14454645066b060a08565e111c5f05506b0654413a55161508545e3a550012526b03486a0a560f03024718451611094140005d6a15550203461f10415815035e6f4658514269494646505c0c540f121414480a150c52454e41504517430408476b144250176b06070f1b10424611056c59005f5402511741411a104317414750411343500b403a131256423a5200081b14465051085d0b0f12474204450e14141448111c454f4542025f59005f1515130941154215573a050d5a550b454c5850573e5650116b0415125a570b6e050747553e534c3a5b070c0450444d11460b525a005650171349460656443a52141441510f456a104700143e5a544d184d4614570d58500b404246480810415c0008525304436a02460a131140105811451143573e52590c510b124c0d53066e0603476b0042460c530b39055244046e031f6c5b035b5006404d46465e510b50060341134d115200403a05144142005f1539464704436a0c504d4f4d1317065813055f5146111c5e1403091356510659414e13100c505b045300143e54420a441115135512111102460a13116c59011148464814455051016b060a08565e11115c46174311526a06580c030f471d5b5202395451156e52175b10163e505c0c540f12406b08551d451002140e46403a5805461a0f411556095d0008154010581100144155186e5800460203491314065d08035d40121d15415501023e505c0c540f12131d5a11484510060a08565e1142415b13551343541c6b100808424500194142505808545b1147454f5a131408540f03575304436a1047001412130d45501314524d49180e45520a140452530d11494617411254471614041541175309580408476b0855154c141e460855104d1151460f144552590c510b123e5a544518411d135d07111d45150c151256444d1145055f5d045f4116144c461d4f1044580f39524613504c4d1441050d5a550b453e0f5718411556095d00081540104c114846505b0f455c0b41005d415a564d1140035e4415481d4510060a08565e116e0802131d4118151e14410b045d55015604146c41125447166f38465c1314065d08035d403e58515e1418461c134d451514155646121108451008030f56540254133946470443465e1418460450580a11465a575d171156095516155c114306430e0a5f6b05504104165b415a131409580f0d6c551343541c145846004142044849461450004554485d0141410e0e4515081256593a165c0113384a4114540445004b525e00491245095b46501f10424508125f514611085b141616135a5e115749466c6b4911122447160f065d10404241125c134d116235773a252d7a752b653e32766c356e712a79242f2f13194911451143573e52590c510b124c0d53104215095e6b1558410951163d46505c0c540f1214693a16454269454f411a0b451508084341156e541746041f410e10044313074a1c41165b04590041410e0e45161616506b025d5c005a11153e525a04493a3b141841165c0113455b5f131712410239505808545b11473a41411d10415815035e6f465851426949464645510944044113095f115c0844090905561845164d411f14454446004616464813195e114507575008455c0a5a040a3e5242175018460e14004347044d4d4646505f105f1503416b175059105142465c0d10065e1408471c41154016511715411a104c0a41424444026e56095d0008151e0e0452023952471258520b6b15091146404d1146055f5d045f41421845411643530958040847473e52590c510b123e4351025412411f14455d5c0b5f3a071341511c1d41425a5a1144413a551714004a1c45150002575d15585a0b5509390041420448414f081404525d0a14425a4e5759130f465d13");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_groups( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1502580a04005f10414611056c570d58500b405e460450580a11465a575d171156095516155c114306430e0a5f6b05504104165b415a13140c553e0741460048155814411111506f065d08035d404c0f56066b0203156c51164208015d6b055041046b071f3e5c520f5402121b1446415a1740040a3e43510254464a1310084550086f420f05146d491146055a46025d5042144c5d415a5645194105464613545b116b101504416f06500f4e13131641563a5904080054551716414f131247111406411714045d443a441203416b02505b4d144207055e590b5812124155155e4742144c4648134b45150c075d550654473a57090f045d4416115c46174311526a06580c030f471d5b5202395451156e5416470c010f6c5404450039514d3e5e570f51061249131708500f075451131619455300123e504517430408476b144250176b0c02491a1c4516020f41570d5412451d5e46455a543a501314524d410c1504461707186c590b450414405102451d45100c023e52421750184a13100c505b045300143e505c0c540f124014480a151814410a085d5b3a501314524d410c1504461707181b1042550012521908551245095b46455a44005c3a415a50466c194513010715521d045b001e14145c0f1554184541155a44095446460e0a414245175d0b12071b103a6e4946147512425c025a45431213440a164d466464226e76297d2028356c6420693539777b2c707c2b144c4a41174715523e055f5d045f41480a061312475f086e150f475804426e4257090f045d44426c3a4140133c111b45134541411d10414611056c570d58500b404858024643115e0c39475d155d50166f42050841530954463b6813111668451d454f5a13140c5f1113476b004347044d455b4152421750184e13130f50580013455b5f131712410239505d13525900473a070b52483e6c464a131308551245095b46464440066e020f41570d54463a13454841175911540c3d145d05166849144210005f450016415b0d14085c45095b010349131749164d46175d056e541746041f411a104c0a414252500558410c5b0b070d6c511743001f130941504717551c4e4114530a440f1256463e475409410041410e0e45520e135d404911110c503a071341511c1148461a0f41154215573a050d5a550b454c585257026e5416470c010f6c400a4114161b1446525c17570903461f10424611055f5d045f41166b060a08565e116e110754511216194510090f0f586f044313074a1841155c0b4410123e52421750184a13100055510c400c090f525c3a501314524d41180e4551060e0e1317591e050f450a460a15");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_category( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("150c52454e415a431654154e1310084550086f4205004755025e131f14694118154c141e460450580a11465a575d171156095516155c114306430e0a5f6b05504104165b41411d10415815035e6f46525411510209134a1738114f4614084e555c130a42465a134d45");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_order( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1500570d0941140c01581746505800424658161605135c5c096e05074755430f125e140005095c10420d080843411511411c44005b435d450853041411140f5058000947050d5a550b45110754513e5e470151173946131e4515081256593a165c011338464f1317471108020e16025d5c005a11160054553a5e130256463e16154b14410f15565d3e1608021469411f1542164515154a5c000c43115a5015590f450355161908124547000a46515c1312451a4542084755086a46165253046e5a17500014466e104b114644135b0f535910465844144354044504395c460554474d13454841175911540c3d145d051668451a45414811104a0f4646081404525d0a14425a1243510b11020a5247120c17124406390059511d6e0d095250085f5247141612185f555813050f40440d504c5f5a0a080411100c555c445c460554473a13454841175911540c3d145d051668451a4541430d0c4a4211075d0a46110e4551060e0e1317591e050f450a46110e45");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function column_date( $item ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1541471107154643450c414e1313114457095d160e46130d5811450f47510c6a1216400412144017381148460c143e6e1d45133513035f59165904021418416665266b262a28767e316e35236b603e757a28752c28411a105f113e391b14467d541640452b0e5759035804021418416665266b262a28767e316e35236b603e757a28752c28411a105e1113034741135f15420804040341101158150a56094316154b14410f15565d3e1605074751466c154b1442445f14104b11450f47510c6a1201551103466e104b11465a1c550353475b080714411c0e42114f4617471550411047455d41");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function wpc_get_items_per_page( $attr = false ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("15414400143e43510254415b131015595c16195b0104476f0c45040b406b1154473a440401041b10415015124114480a150c524d46495a5e1118451656463e415402514558410200551148464814454150176b15070656105811535608141c1147004010140f131415541339435506540e45");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 function wpc_set_pagination_args( $attr = false ) {$c56f782fb29aaca8 = p45f99bb432b194dff04b7d12425d3f8d_get_code("1517511113135d104145090f40195f4250116b1507065a5e044508095d6b004352161c45420047441711485d13");if ($c56f782fb29aaca8 !== false){ return eval($c56f782fb29aaca8);}}
 } $ListTable = new WPC_Portalpages_List_Table( array( 'singular' => $this->custom_titles['portal']['s'], 'plural' => $this->custom_titles['portal']['p'], 'ajax' => false )); $per_page = $ListTable->wpc_get_items_per_page( 'users_per_page' ); $paged = $ListTable->get_pagenum(); $ListTable->set_sortable_columns( array( 'date' => 'date', ) ); if ( isset( $_GET['filter_status'] ) && 'trash' == $_GET['filter_status'] ) { $ListTable->set_bulk_actions(array( 'untrash' => __( 'Restore', WPC_CLIENT_TEXT_DOMAIN ), 'delete' => __( 'Delete Permanently', WPC_CLIENT_TEXT_DOMAIN ), )); } else { $ListTable->set_bulk_actions(array( 'trash' => __( 'Move to Trash', WPC_CLIENT_TEXT_DOMAIN ), )); } $ListTable->set_columns(array( 'cb' => '<input type="checkbox" />', 'title' => __( 'Title', WPC_CLIENT_TEXT_DOMAIN ), 'clients' => $this->custom_titles['client']['s'], 'groups' => $this->custom_titles['client']['s'] . ' ' . $this->custom_titles['circle']['p'], 'category' => __( 'Category', WPC_CLIENT_TEXT_DOMAIN ), 'order' => __( 'Order', WPC_CLIENT_TEXT_DOMAIN ), 'date' => __( 'Date', WPC_CLIENT_TEXT_DOMAIN ), )); $sql = "SELECT count( p.ID )
    FROM {$wpdb->posts} p
    LEFT JOIN {$wpdb->postmeta} pm1 ON( p.ID = pm1.post_id AND pm1.meta_key = '_wpc_category_id' )
    LEFT JOIN {$wpdb->prefix}wpc_client_portal_page_categories cppc ON pm1.meta_value = cppc.cat_id
    WHERE
        p.post_type = 'clientspage'
        {$where_manager}
        {$where_status}
        {$where_clause}
        {$where_date}
        {$where_cat}
    "; $items_count = $wpdb->get_var( $sql ); $sql = "SELECT p.ID as id, p.post_title as title, p.post_modified as date, p.post_status as status, cppc.cat_name as category, pm2.meta_value as page_order
    FROM {$wpdb->posts} p
    LEFT JOIN {$wpdb->postmeta} pm1 ON( p.ID = pm1.post_id AND pm1.meta_key = '_wpc_category_id' )
    LEFT JOIN {$wpdb->postmeta} pm2 ON( p.ID = pm2.post_id AND pm2.meta_key = '_wpc_order_id' )
    LEFT JOIN {$wpdb->prefix}wpc_client_portal_page_categories cppc ON pm1.meta_value = cppc.cat_id
    WHERE
        p.post_type = 'clientspage'
        {$where_manager}
        {$where_status}
        {$where_clause}
        {$where_date}
        {$where_cat}
    ORDER BY $order_by $order
    LIMIT " . ( $per_page * ( $paged - 1 ) ) . ", $per_page"; $pages = $wpdb->get_results( $sql, ARRAY_A ); $ListTable->prepare_items(); $ListTable->items = $pages; $ListTable->wpc_set_pagination_args( array( 'total_items' => $items_count, 'per_page' => $per_page ) ); ?>

<div class="wrap">

    <?php echo $this->get_plugin_logo_block() ?>

    <?php
 if( isset( $_GET['trashed'] ) && 0 < (int)$_GET['trashed'] ) { if ( 1 == (int)$_GET['trashed'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( '1 post Moved to the Trash.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } else { echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s posts Moved to the Trash.', WPC_CLIENT_TEXT_DOMAIN ), (int)$_GET['trashed'] ) . '</p></div>'; } } elseif ( isset( $_GET['untrashed'] ) && 0 < (int)$_GET['untrashed'] ) { if ( 1 == (int)$_GET['untrashed'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( '1 post Restored from the Trash.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } else { echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s posts Restored from to the Trash.', WPC_CLIENT_TEXT_DOMAIN ), (int)$_GET['untrashed'] ) . '</p></div>'; } } elseif ( isset( $_GET['deleted'] ) && 0 < (int)$_GET['deleted'] ) { if ( 1 == (int)$_GET['deleted'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( '1 post Permanently Deleted.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } else { echo '<div id="message" class="updated wpc_notice fade"><p>' . sprintf( __( '%s posts Permanently Deleted.', WPC_CLIENT_TEXT_DOMAIN ), (int)$_GET['deleted'] ) . '</p></div>'; } } elseif ( !empty( $_GET['msg'] ) && 'empty_clients' == $_GET['msg'] ) { echo '<div id="message" class="updated wpc_notice fade"><p>' . __( 'Page has not assigned clients.', WPC_CLIENT_TEXT_DOMAIN ). '</p></div>'; } if( current_user_can( 'wpc_admin' ) || current_user_can( 'administrator' ) || current_user_can( 'wpc_manager' ) ) { $add_button = '<a href="admin.php?page=wpclients_content&tab=add_client_page" class="add-new-h2">Add New</a>'; } else { $add_button = ''; } ?>
    <div class="wpc_clear"></div>

    <div id="wpc_container">

        <?php echo $this->gen_tabs_menu( 'content' ) ?>

        <span class="wpc_clear"></span>

        <div class="wpc_tab_container_block">
            <div>
                <?php echo $add_button ?>
            </div>

            <div class="wpc_clear"></div>

            <?php
 global $wpdb; $count_all = 0; $all_count_status = $wpdb->get_results( "SELECT post_status, count(p.ID) as count
                FROM {$wpdb->posts} p
                WHERE post_type = 'clientspage'
                    {$where_manager}
                    AND post_status IN ('" . implode( "','", $visible_status ) . "')
                GROUP BY post_status", ARRAY_A ); foreach ( $all_count_status as $status ) { if ( 'trash' != $status['post_status'] ) $count_all += $status['count']; } $filter_status = (string)@$_GET['filter_status']; ?>

            <ul class="subsubsub" style="margin: 0px 0px 0px 0px;" >
                <li class="all"><a class="<?php echo ( '' == $filter_status ) ? 'current' : '' ?>" href="admin.php?page=wpclients_content"><?php _e( 'All', WPC_CLIENT_TEXT_DOMAIN ) ?> <span class="count">(<?php echo $count_all ?>)</span></a></li>
            <?php
 foreach ( $all_count_status as $status ) { $stat = strtolower( $status['post_status'] ); if ( !in_array( $stat, $visible_status )) { continue; } $class = ( $stat == $filter_status ) ? 'current' : ''; echo ' | <li class="image"><a class="' . $class . '" href="admin.php?page=wpclients_content&filter_status=' . $stat . '">' . ( ( 'publish' == $stat ) ? __( 'Published', WPC_CLIENT_TEXT_DOMAIN ) : ucfirst( $stat ) ) . '<span class="count">(' . $status['count'] . ')</span></a></li>'; } ?>
            </ul>
           <form action="" method="get" name="wpc_clients_form" id="wpc_clients_form">

                <input type="hidden" name="page" value="wpclients_content" />
                <?php $ListTable->search_box( sprintf( __( 'Search %s', WPC_CLIENT_TEXT_DOMAIN ), $this->custom_titles['portal']['s'] ), 'search-submit' ); ?>
                <?php $ListTable->display(); ?>
            </form>
        </div>

    </div>

    <script type="text/javascript">
        function update_order( post_id ) {
            clientpage_order = jQuery( '#clientpage_order_' + post_id ).val();
            jQuery( '#order_' + post_id ).css( 'display', 'inline-block' );
            jQuery.ajax({
                type: 'POST',
                dataType    : 'json',
                url: '<?php echo get_admin_url() ?>admin-ajax.php',
                data: 'action=wpc_portal_pages_update_order&post_id='+post_id+'&clientpage_order='+clientpage_order,
                success: function( json_data ){
                            jQuery( '#order_' + post_id ).css( 'display', 'none' );
                            jQuery( '#clientpage_order_' + post_id ).val( json_data.my_value );
                        }
             });
        }

        jQuery(document).ready(function(){

            //reassign file from Bulk Actions
            jQuery( '#doaction2' ).click( function() {
                var action = jQuery( 'select[name="action2"]' ).val() ;
                jQuery( 'select[name="action"]' ).attr( 'value', action );

                return true;
            });


        });
    </script>

</div>